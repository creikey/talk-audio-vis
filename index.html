<html>
<head>

<script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

<script type="module" src="main.js"></script>

<!-- <style>
/* this stuff is just to make the canvas fullscreen */
* { margin:0; padding:0; } /* to remove the top and left whitespace */
html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
canvas { display:block; } /* To remove the scrollbars */
button { width: 10em; height: 10%; font-size: 200%; }
#button-div {
	display: flex;
	align-items: center;
	justify-content: center;
	text-align: center;
	width: 100%;
	height: 100%;
	position: absolute;
}
</style> -->

</head>

<body>
	<img src="ui_mockup.png" style="position:absolute; z-index: -1;">

	<!-- <div id="button-div">
		<button onclick="start()">Start</button>
	</div>
	<canvas id="canvas" style="display: none;">
	</canvas>
 -->
	<script>
/*
var canvas = document.getElementById("canvas");
var button_div = document.getElementById("button-div");

var analyser;

function draw() {
	var width = canvas.width;
	var height = canvas.height;
	var ctx = canvas.getContext("2d");

	const bufferLength = analyser.frequencyBinCount;
	const dataArray = new Float32Array(bufferLength);
	analyser.getFloatFrequencyData(dataArray);

	ctx.clearRect(0, 0, width, height);

	ctx.strokeStyle = "rgb(255, 0, 0)";
	ctx.lineWidth = 3.0;

	function line(from_x, from_y, to_x, to_y) {
		ctx.moveTo(from_x, from_y);
		ctx.lineTo(to_x, to_y);
	}

	function map_range(value, low1, high1, low2, high2) {
		// https://stackoverflow.com/questions/5649803/remap-or-map-function-in-javascript
		return low2 + (high2 - low2) * (value - low1) / (high1 - low1);
	}

	const center_x = width/2.0;
	const center_y = height/2.0;
	const radius_circle = width * 0.05;
	const minimum_radius = radius_circle * 1.08;
	const radius_lines_max = radius_circle * 3.5;

	ctx.beginPath();
	let frequency_padding = 200;
	if(bufferLength > frequency_padding) {
		// don't do the super low or the super high frequencies
		let end = bufferLength - Math.floor(frequency_padding/2);
		let begin = Math.floor(frequency_padding / 2);
		let bufferLength_after_padding = end - begin;
		for(let i = begin; i < end; i++) {
			const theta = (i/bufferLength_after_padding) * 2.0 * 3.14159;

			const unit_x = Math.cos(theta);
			const unit_y = Math.sin(theta);

			const from_x = center_x + unit_x * radius_circle;
			const from_y = center_y + unit_y * radius_circle;

			let this_frequency_volume_decibles = dataArray[i];
			// decibles is like from -140 to -70 on my machine right now, so just scale it from 0 to 1 in terms of loudness like that
			let loudness_of_this_frequency = 1.0 - (-this_frequency_volume_decibles)/140.0;

			let cur_line_amount = loudness_of_this_frequency;
			let effective_radius = cur_line_amount * (radius_lines_max - radius_circle) + radius_circle;
			if(effective_radius < minimum_radius) effective_radius = minimum_radius;
			const to_x = center_x + unit_x * effective_radius;
			const to_y = center_y + unit_y * effective_radius;

			line(from_x, from_y, to_x, to_y);
		}
	}
	ctx.stroke();


	window.requestAnimationFrame(draw);
}

function start() {
	button_div.style.display = "none";
	canvas.style.display = "block";
	const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
	analyser = audioCtx.createAnalyser();
	analyser.fftSize = 1024;

	navigator.mediaDevices.getUserMedia({ audio: true })
		.then(stream => {
			// Create a media stream source node
			const source = audioCtx.createMediaStreamSource(stream);
			source.connect(analyser);
			window.requestAnimationFrame(draw);
		})
		.catch(error => {
			console.error('Error accessing microphone:', error);
		});
}

function resizeCanvas() {
	canvas.width = window.innerWidth;
	canvas.height = window.innerHeight;
}

window.addEventListener('resize', resizeCanvas, false);
resizeCanvas();
 */
	</script>
</body>
</html>
